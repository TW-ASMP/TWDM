---
$schema: "http://json-schema.org/draft-07/schema#"
title: item master
$id: https://raw.githubusercontent.com/TW-ASMP/TWmaximoConfig/main/1-Schemas/A-entity_record_schema/05_item_master_schema.yml
type: object

properties:
  
  ID:
  #---------------------------------------
    description: A read-only UUID, generated by the system, to uniquely identify the item.
    type: string
    implementer_note: |
      Use UUID instead of a serial - this allow us to incorporate future items defined outside of TW.
  
  description:
  #---------------------------------------
    description: A human readable short description of the item.
    type: string
    
    rule_spec:
      - name: item master record naming
        form: long
        spec_ID: VkYgCtRPlx
        type: assertion
        specification: |
          if (item_x.properties.commodity_or_commercial_product) = "commodity", then  
            the value of item_x.properties.name would be the semi-colon delimited concatenation of the following property values:
              - properties.class.properties.name
              - every non-empty class dependent specification values
              - properties.supplementary_commodity_description
          elif: (item_x.properties.commodity_or_commercial_product = "commercial product"), then: 
            the value of item_x.properties.name would be the semi-colon delimited concatenation of the following property values:
              - properties.class.properties.name
              - properties.product manufacturer company.properties."company name"
              - properties.model_and_sub-model
              - properties.version_or_model_year
              - properties.product configuration code
        checked on: 2024-08-15
  
  class:
  #---------------------------------------
    description: indicates the class to which this asset is an instance.
    $ref: "../B-entity_class_object_schema/01_asset_item_tool_class.yml"
    $comment: A value from the item classification (a superset of the asset class).
    rule_spec:
      - name: item classification list includes all classes
        spec_ID: EynXVZ-dxg
        specification: |
          Maximo item classification list would include all class instances of B-entity_class_object_schema/01_asset_item_tool_class_object_schema.yml, regardless of the values
            - properties.tool
            - properties.only used as a part asset
        status: specified
        checked_on: 2024-08-15

  class_dependent_specifications:
  #---------------------------------------
    description: A set of properties applicable to the class value. 
    type: object

  rotating:
  #---------------------------------------
    description: Signifies that instances of this item are tracked as serialized individuals.
    $ref: "./00_common_definitions.yml#/definitions/rotating_property_def" 

  material_item:
  #---------------------------------------
    description: indicates that the item is a material item
    type: boolean
    $comment: |
      Concept of material: materials are often handled in continuous quantities. For example, you might purchase a certain length of piping or a volume of concrete, and you have to measure and cut or shape these materials to fit your project's requirements.
  
  # GENERIC COMMODITY AND SPECIFIC PRODUCT DEFINITION
  #=======================================

  commodity_or_commercial_product:
  #---------------------------------------
    description: Indicate whether the item master defines an unspecialized commodity or a specific commercial product of a certain manufacturer.
    type: string
    enum:
      - commodity
      - commercial product

  # GENERIC COMMODITY DESCRIPTION
  #=======================================
  
  supplementary_commodity_description:
  #---------------------------------------
    description: Supplementary description, in addition to the class value and class-dependent specification values, necessary to differentiate a commodity.
    type: string
    $comment: Toronto Water is not using the UNSPSC or any other commodity taxonomy code for item identification, as Toronto Water's classification system plays the same role and can be mapped to other taxonomies. 


  # SPECIFIC PRODUCT DESCRIPTION
  #=======================================

  commercial_product:
  #---------------------------------------
    description: 
    oneOf: 
      - type: null
      - $ref: "./00_common_definitions.yml#/definitions/manufacturer_and_model_def"
  
  commercial_product_description:
  #---------------------------------------
    description: A description formed from the concatenation of the components of the commercial product.
    oneOf: 
    - type: null
    - type: string
    rule_spec:
      - name: Concatenation of commercial product description
        status: TBD
  
  instant_of_generic_commodity:
  #---------------------------------------
    description: indicates that the specific product is also an instance of a commodity
    oneOf: 
      - type: null
      - $ref: "./05_item_master.yml"
    rule_spec:
      - description: range of the instant_of_generic_commodities property must be items whose TW_defined_commodity value is 'true'.
        form: short
        spec_ID: 01JF33GVB2DT7K5FJ3SA3P9EP4

  # OTHER ITEMS DESCRIPTIONS
  #=======================================

  format_of_individual_unit:
  #---------------------------------------
    description: describes the format of individual unit - for example, "500ml can" "24x300inch role", "an object", or "a set of objects".
    type: string

  unit_cost_in_CAD:
  #---------------------------------------
    description: The expected of the item in the order format
    type: number
    $comment: In the future, this field should contain a average cost 

  unit_of_issue:
  #---------------------------------------
    description: describes how the quantity of product is measured, when it is issued to work, such as "feet", "kg", or "individual unit".
    type: string
    rule_spec:
      - name: Unit of issue for assets and parts (non-material items)
        spec_ID: 01JK1VER5T6HK314XPB4W5T27V
        type: validation
        form: short
        description: if the item is not an material item, its unit of issue would be "individual unit"

  equivalent_items:
  #---------------------------------------
    description: |
      Usually identifies the same commercial product item made by the same manufacturer, but differing only in the format of the individual unit. For example, the 208-litre drum item and the 5-litre bottle item of Penzoil 5W30 Synthetic Lubricant. 
    oneOf: 
      - type: null
      - type: array
        items:
          $ref: "./04_item_master.yml"
    rule_spec:
      - name: Range must be a commercial product as well
        spec_ID: 01JF81079K178X9B4NSG23AA0Z
        type: validation
        specification: 
        status: TBD

  ordering_options:
  #---------------------------------------
    description: presents a list of vendors and available order formats
    oneOf:
      - type: null
      - type: array
        items:
          type: object
          properties:

            vendor:
            #>---------------------------------------    
              $ref: MaximoCompanyObject
            
            packaging_format:
            #>---------------------------------------
              type: object
              properties:

                description_of_format:
                #>>--------------------------------------- 
                  description: a description the packages of individual units such as "box of 24" or "individual unit"
                  type: string
                
                number_in_package:
                #>>---------------------------------------
                  description: indicate the number of individual units that are in the package
                  type: number

              rule_spec:
                - name: Default order packaging format
                  description: Default order packaging format is "individual unit"
                  form: short
                  spec_ID: 01JK1KEZSR9ASBXMWE406TCBPN
            
            vendor_item_number:
            #>---------------------------------------
              oneOf:
                - type: string
                - type: null
              
            cost_in_CAD:
            #>---------------------------------------
              description: The expected of the item in the order format
              type: number
              $comment: To TW, in the future, this field should contain a running average of the recent purchase costs, possibly also adjusted for recent inflation.
            
            contracts:
            #>---------------------------------------
              description: the existing contracts that can be used for order the product
              $ref: MaximoContractObject
              