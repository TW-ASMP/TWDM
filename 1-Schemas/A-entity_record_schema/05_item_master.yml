---
$schema: "http://json-schema.org/draft-07/schema#"
title: item master
$id: https://raw.githubusercontent.com/TW-ASMP/TWDM/main/1-Schemas/A-entity_record_schema/05_item_master_schema.yml
type: object

properties:
  
  ID:
    P3_MVP: true
    description: A read-only UUID, generated by the system, to uniquely identify the item.
    type: string
    implementer_note: |
      Use UUID instead of a serial - this allow us to incorporate future items defined outside of TW.
  
  description:
    P3_MVP: true
    description: A human readable short description of the item.
    type: string
    RULE_SPEC:
      - name: item master record naming
        P3_MVP: TBD
        form: long
        spec_ID: VkYgCtRPlx
        type: automatic_assertion
        specification: |
          if (item_x.properties.commodity_or_commercial_product) = "commodity", then  
            the value of item_x.properties.name would be the semi-colon delimited concatenation of the following property values:
              - properties.class.properties.name
              - every non-empty class dependent specification values
              - properties.supplementary_commodity_description
          elif: (item_x.properties.commodity_or_commercial_product = "commercial product"), then: 
            the value of item_x.properties.name would be the semi-colon delimited concatenation of the following property values:
              - properties.class.properties.name
              - properties.product manufacturer company.properties."company name"
              - properties.model_and_sub-model
              - properties.version_or_model_year
              - properties.product configuration code
        checked on: 2024-08-15
  
  class:
    P3_MVP: true
    description: indicates the class to which this asset is an instance.
    $ref: "../B-entity_class_object_schema/01_asset_item_tool_class.yml"
    $comment: A value from the item classification (a superset of the asset class).
    RULE_SPEC:
      - name: item classification list includes all classes
        spec_ID: EynXVZ-dxg
        specification: |
          Maximo item classification list would include all class instances of B-entity_class_object_schema/01_asset_item_tool_class_object_schema.yml, regardless of the values
            - properties.tool
            - properties.only_used_as_a_part asset
        status: specified
        checked_on: 2024-08-15

  rotating:
    P3_MVP: true
    description: Signifies that instances of this item are tracked as serialized individuals.
    $ref: "./00_common_definitions.yml#/definitions/rotating_property_def" 

  material_item:
    P3_MVP: true
    description: indicates that the item is a material item, which are handled in continuous quantities.
    type: boolean
    $comment: |
      Concept of material: materials are often handled in continuous quantities. For example, you might purchase a certain length of piping or a volume of concrete, and you have to measure and cut or shape these materials to fit your project's requirements.
  
  # GENERIC COMMODITY AND COMMERCIAL PRODUCT DEFINITION

  commodity_or_commercial_product:
    P3_MVP: true
    description: Indicate whether the item master defines an unspecialized commodity or a specific commercial product of a certain manufacturer.
    type: string
    enum:
      - commodity
      - commercial product
    RULE_SPEC:
      - name: a commercial product item record must have manufacturer's information
        spec_ID: 01K1E8JE4G5T00RQP63S0BPJBV
        type: [constraint_or_validation] 
        specification: |
          If commodity_or_commercial_product = "commercial product", then the following properties must NOT be null:
            - manufacturer_company_name
            - make_and_model
        status: check 07/30
      - name: a commodity item cannot be subset of another commodity item
        spec_ID: 01K1E9YNYCMZQ5SNTF14723TND
        type: [constraint_or_validation] 
        specification: |
          If commodity_or_commercial_product = "commodity", then the subset_of_commodity_item property value must be NULL.
        remark: This rule is instated to avoid complexity, such as circularity, in the manufacturer make and model data.
        status: check 07/30

  # GENERIC COMMODITY DESCRIPTION
  
  supplementary_commodity_description:
    P3_MVP: true
    description: Supplementary description, in addition to the class value and class-dependent specification values, necessary to differentiate a commodity.
    type: string
    $comment: Toronto Water is not using the UNSPSC or any other commodity taxonomy code for item identification, as Toronto Water's classification system plays the same functional-location and can be mapped to other taxonomies. 

  # COMMERCIAL PRODUCT DESCRIPTION

  manufacturer_company_name:
    oneOf:
    - type: null
    - type: string
    description: The commercial entity that has manufactured the product or for whom the product was manufacturer.

  make_and_model:
    oneOf:
    - type: null
    - type: string
    description: The complete brand, model, and sub-model description. For example, "GE Multilin 869"
    dev_note: 
      P3_MVP: true 
      P1_label: 
      DB: 

  product_version_or_model_year:
    oneOf:
    - type: null
    - type: string
    description: Identifies the specific version of the product model. For example "v2" or "2023".
    dev_note: 
      P3_MVP: true 
      P1_label: 
      DB: 
  
  subset_of_commodity_item:
    P3_MVP: true
    description: Indicates the commercial product is also a type of generic commodities.  
    oneOf: 
      - type: null
      - type: array
        items:
          $ref: "./05_item_master.yml"
    dev_note: 
      P3_MVP: false
      P1_label: 
      DB: 

  # OTHER ITEMS DESCRIPTIONS

  item_format:
    P3_MVP: false
    description: Describes the format of the individual units (forming the inventory count)- for example, "can" "functional-location", "sheet", "object", "box", "bag",....
    type: string

  specification_data:
    P3_MVP: false
    type: object
    description: is a set of specification property data. (The applicable properties are dependent on the definition made in the chosen class.)

  cost_in_CAD:
    P3_MVP: false
    description: The expected cost of an each unit of the item.
    type: number

  unit_of_issue:
    P3_MVP: false
    description: Describes how the quantity of the item is measured, when it is issued out, such as "feet", "kg", "sheet".
    type: string
    RULE_SPEC:
      - name: Unit of issue for assets and parts (non-material items)
        spec_ID: 01JK1VER5T6HK314XPB4W5T27V
        type: constraint_or_validation
        form: short
        description: if the item is not an material item, its unit of issue would be "individual item"
      - name: Default value of  unit_of_issue
        spec_ID: 01JK7AM2RA8S8EPAH57W33SJ79
        type: automatic_assertion
        form: short
        description: When an item record is created, the default unit of issue is the same as the item format. 

  quantity_in_units_of_issue:
    P3_MVP: false
    description: indicates how many units of issue is in the item.
    type: number
    RULE_SPEC:
      - name: Default quantity in units
        spec_ID: 01JK7AFSHFQ2W8G5JD3B9XSWBV
        type: automatic_assertion
        form: short
        description: When an item record is created, the default value of quantity_in_units_of_issue is 1. 
  
  alternate_format_of_same_item:
    P3_MVP: false
    description: |
      Usually identifies the same commercial product item made by the same manufacturer, but differing only in the format. For example, the 208-litre drum item and the 5-litre bottle item of Penzoil 5W30 Synthetic Lubricant. 
    oneOf: 
      - type: null
      - type: array
        items:
          $ref: "./04_item_master.yml"
    RULE_SPEC:
      - name: Range must be a commercial product as well
        spec_ID: 01JF81079K178X9B4NSG23AA0Z
        type: constraint_or_validation
        specification: 
        status: TBD
  
  ordering_options:
    description: presents a list of vendors and available order formats
    oneOf:
      - type: null
      - type: array
        items:
          type: object
          properties:
            vendor:
              $ref: MaximoCompanyObject
            
            unit_of_order:
              type: object
              properties:
                description:
                  description: a description the packages of individual units such as "box of 24" or "individual unit"
                  type: string
                number_in_package:
                  description: indicate the number of items that are in the package
                  type: number
              RULE_SPEC:
                - name: Default order packaging format
                  description: Default order packaging format is "individual unit"
                  form: short
                  spec_ID: 01JK1KEZSR9ASBXMWE406TCBPN
            
            vendor_item_number:
              oneOf:
                - type: string
                - type: null
            
            cost_in_CAD:
              description: The expected of the item in the order format
              type: number
              $comment: To TW, in the future, this field should contain a running average of the recent purchase costs, possibly also adjusted for recent inflation.
            
            contracts:
              description: the existing contracts that can be used for order the product
              $ref: MaximoContractObject

  # COMMON RECORD PROPERTIES

  duplicate_record_of:
    P3_MVP: true
    $ref: "./00_common_definitions.yml#/definitions/duplicate_record_def"

  record_retirement_information:
    P3_MVP: true
    $ref: "./00_common_definitions.yml#/definitions/record_retirement_def"