---
$schema: http://json-schema.org/draft-07/schema#
title: PM
#$id:
type: object

properties:

  ID:

    description: is a read-only, unique, and permanent ID, generated by the system, to identify PM. 
    type: string
    comment: This ID is useful for referencing, even when its name changes. 

  name:

    description: a short name for the PM, given by the creator of the PM.
    type: string

  maintainer_group:

    description: identifies the group/org, from the organizational hierarchy, directly responsible for performing the work order arising from the PM. 
    $ref: "./04_org_or_group.yml"
    
  operational_unit:

    description: indicates Toronto Water's operational unit, such as Waste and Storm Water Pumping (symbol - WASP) or Humber Wastewater Treatment Plant (symbol - THR).
    $ref: "./04_org_or_group.yml"
    comment: This value will be determined by (and must be consistent with) the maintainer_organization value - situated at a lower level of the organization hierarchy

  member_of_PM_set:

    description: indicates that this PM is a member of a set of related PMs. For example, the PMs for raw water pump 1, 2, 3 are all members of a PM set named Raw Water 5-year Disassembly Maintenance. 
    $ref: "#/definitions/PM_set"

  Avantis_PM:

    description: indicate the Avantis PM that this Maximo PM (equivalent to an Avantis PM task) was a part of.
    read_only: TRUE
  
  processes_or_major_systems:

    description: a list of all major systems covered by the work specified in this PM.
    read_only: TRUE
    oneOf:
      - type: NULL
      - type: object
        properties:
          
          ranking:
            type: number
          
          system_naming:
            type: string
        
  maintenance_work_specification:
    
    description: a sequential list of job plan and entity pairings. 
    type: array
    items: "#/definitions/a_piece_of_work_specification"
  
  #==== Resources ====

  tool_requirement:
  
    description: identifies the tools required to complete a work order generated from the PM.
    oneOf:
      - type: NULL
      - type: array
        items:
          - $ref: "./00_common_definitions.yml#/definitions/tool_requirement_definition"

  #================

  parts_and_material_requirement:
    
    description: identifies the parts or material required to complete a work order generated from the PM.
    oneOf:
      - type: NULL
      - type: array
        items:
          - $ref: "./00_common_definitions.yml#/definitions/item_requirement_definition"

  #================
  
  services_requirement:

    description: identifies (contracted) service needed to complete to complete a work order generated from the PM.
    oneOf:
      - type: NULL
      - type: array
        items:
          - $ref: "./00_common_definitions.yml#/definitions/service_requirement_definition"

  #================
  
  trades_requirement:
  
    description: identifies the trade and qualifications needed to complete the work.
    oneOf:
    - type: NULL
    - type: array
      items:
        - $ref: "./00_common_definitions.yml#/definitions trade_requirement_definition"

  #==== Work order triggering =====
  
  trigger_specification:

    start_date:

    last_trigger_date:

      read_only: TRUE

    reset_count_on:
      description:
      enum:
        - trigger
        - work completion

    trigger_condition:

      oneOf:
      - type: NULL
      - $ref: "#/definitions/time-based_trigger_specification"
      - $ref: "#/definitions/meter-based_trigger_specification"
      - $ref: "#/definitions/calender-based_trigger_specification"

  #======Legislative Designation=======
  
  PM_compliance_class:

    $ref: "./00_common_definitions.yml#/definitions/compliance_class"


##########################################################
# LOCAL OBJECT DEFINITIONS
##########################################################

definitions:

  time-based_trigger_specification:
    
    $ref: "./00_common_definitions.yml#/definitions/interval_definition"
    
  calender-based_trigger_specification:

    properties:

      month_of_year:
      
      week_of_month:

      day_of_week:      
      

  meter-based_trigger_specification:

    properties:

      meter_type:

      count:

      unit_of_measure:   

  a_piece_of_work_specification: