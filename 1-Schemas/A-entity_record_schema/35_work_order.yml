$schema: http://json-schema.org/draft-07/schema#
title: Work Order
$id: https://raw.githubusercontent.com/TW-ASMP/TWmaximoConfig/main/1-Schemas/A-entity_record_schema/35_work_order.yml


properties:

  ID:

    description: is a read-only, unique, and permanent ID, generated by the system. 
    type: string
    $comment: This ID is useful for referencing, even when its name changes. 

  # ==========

  name:

    description: a short name for the PM, given by the creator of the PM.
    type: string

  # ==========

  operational_unit:

    description: indicates Toronto Water's operational unit, on the organizational hierarchy, such as Waste and Storm Water Pumping (symbol - WASP) or Humber Wastewater Treatment Plant (symbol - THR).
    $ref: "./04_org_or_group.yml"
      # ==========

  status !!:

    description:

  # ==========

  priority !!:

    description:

  # ==========

  requires_shut_down !!:

    description:
  
  # Failure Information Inherited
  #================================

  description_of_issue:

    description: is a free-text description of the observable aspects of (what is perceived to be) a single issue.
    guide_text: Only enter the *observable* aspects (or failure conditions directly inferrable from the observable aspects) of the issue. 
    type: string

  #================

  problem_codes:

    description: is what is also known as a common symptom code (e.g., making noise, cannot start, not running).
    oneOf:
      - type: boolean
      - type: array
        items:
          $ref: "#/definitions/issue_code"
    $comment: The user should be allowed to enter multiple failure codes related to a failure  []todo - anyone can problem a draft issue code
  
  #================
  
  failure_codes!!:

    description: is a more definitive indication of failure condition (e.g., shaft-misalignment). 
    oneOf:
      - type: boolean
      - type: array
        items:
          $ref: "#/definitions/issue_code"
    $comment: The user should be allowed to enter multiple failure codes related to a failure
  

  # CLASSIFICATIONS
  #================================

  work_type:

    description: is a high-level classification of the purpose of the work
    $ref: "../B-entity_class_object_schema/33_work_type.yml"
    $comment: In a work order hierarchy, the top-level work order determines the work type at all other levels.  

  #================

  discrete_activity_classification:

    description: is a classification often inherited from the job plan specified on the work order
    $ref: "../B-entity_class_object_schema/33_work_type.yml"

  # ==========

  supervisor_group:

    description: indicates a sub-group of the operational unit, that is led by a supervisor who is accountable for the performance of the specified work. 
    $ref: "./04_org_or_group.yml"
    
  # ==========
  
  crew_assignment:

    description: identifies a crew, under the supervisor group, that is always assigned to perform the specified work
    
    oneOf:
      - type: null
      - $ref: "./04_org_or_group.yml"
    
    comment: This value will be determined by (and must be consistent with) the maintainer_organization value - situated at a lower level of the organization hierarchy

  # ==========

  trades_assignment:

    description: identifies the individual trades-persons who will be performing the work order. 
    
    oneOf:
      - type: null
      - $ref: "./08_person.yml"


  # ==========

  member_of_PM_set:

    description: indicates that this PM is a member of a set of related PMs. For example, the PMs for raw water pump 1, 2, 3 are all members of a PM set named Raw Water 5-year Disassembly Maintenance. 
    
    oneOf:
      - type: null
      - $ref: "#/definitions/PM_set"

  # ==========

  parent_work_order:

    description: indicates the more comprehensive PM, usually a shut-down PM, that this PM is a part of.
    
    oneOf:
      - type: null
      - $ref: "../A-entity_record_schema/33_PM.yml"
    
    $comment: PMs should be organized into a PM-set when they are meant to be performed at different times.  For example the PMs for substation line 1 and line 2 maintenance are performed on alternating years. They can be organize into a PM-Set named Main Substation Maintenance. PMs should be organized under a parent PM if they are parts of the same larger continuous process - represented by the parent - such as the winter shutdown maintenance of island treatment plant. 
  
  
  # Work Specification at a High-level
  #========================================

  role:

    description: specifies the role for the PM, if there is no further specification within the route.

  # ========
  
  asset:

    description: specifies the job plan for the PM, if there is no further specification within the route.

  # ==========

  job_plan:
  
    description: specifies the job plan for the PM, if there is no further specification within the route.
    

  # Work Specification at the Route Level
  #========================================

  route:
    
    description: a sequential list of work, composed of job plans paired with an asset/role. 
    oneOf:
      - type: null
      - type: object
        properties:
           
          sequence:
            type: number
          
          asset:
            oneOf:
              - type: null
              - $ref: "./01_asset.yml"

          role:
            oneOf: 
              - type: null
              - $ref: "./02_role.yml"

          job_plan:
            $ref: "./32_job_plan.yml"
    
    $comment: the implementation could be done with Maximo route object.    


  #========================================
  # Resources
  #----------------------------------------
  # Note: Travel time and preparation time are not being recorded explicitly on the PM. Instead they could be recorded as contributory work in the job plan route
  #========================================

  
  estimated_duration !!:
  

  
  #================
  
  tool_requirement:
  
    description: identifies the tools required to complete a work order generated from the PM.
    oneOf:
      - type: null
      - type: array
        items:
          $ref: "./00_common_definitions.yml#/definitions/tool_requirement_definition"

  #================

  parts_and_material_requirement:
    
    description: identifies the parts or material required to complete a work order generated from the PM.
    oneOf:
      - type: null
      - type: array
        items:
          $ref: "./00_common_definitions.yml#/definitions/item_requirement_definition"

  #================
  
  services_requirement:

    description: identifies (contracted) service needed to complete to complete a work order generated from the PM.
    oneOf:
      - type: null
      - type: array
        items:
          $ref: "./00_common_definitions.yml#/definitions/service_requirement_definition"

  #================
  
  trades_requirement:
  
    description: identifies the trade and qualifications needed to complete the work.
    oneOf:
    - type: null
    - type: array
      items:
        $ref: "./00_common_definitions.yml#/definitions trade_requirement_definition"
  

  #========================================
  # Legislative Designation
  #========================================
  
  PM_compliance_class:

    $ref: "./00_common_definitions.yml#/definitions/compliance_class"

